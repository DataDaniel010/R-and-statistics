n <- 160 # Сколько виртуальных добровольцев включим в исследование?
mean_Hg <- +15 # Истинный средний прирост гемоглобина в генеральной совокупности
sd_Hg <- 10 # Истинное стандартное отклонение (вариабельность) прироста гемоглобина в генеральной совокупности
errors <- sapply(1:1000, function(x){
df <- data.frame(
ID =  1:n,
Hg = round( rnorm(n, mean = mean_Hg, sd = sd_Hg) )
)
est_mean_Hg <- mean(df$Hg)
est_mean_Hg - mean_Hg
})
hist(errors) # Как мы ошибались в разных исследованиях?
print(sqrt(mean(errors^2))) # Как нам правильно усреднить величину ошибки?
#SE, standard error, стандартная ошибка, истинная стандартная ошибка, так как знаем правильный ответ (среднее в ГС)
n <- 1000 # Сколько виртуальных добровольцев включим в исследование?
mean_Hg <- +15 # Истинный средний прирост гемоглобина в генеральной совокупности
sd_Hg <- 10 # Истинное стандартное отклонение (вариабельность) прироста гемоглобина в генеральной совокупности
errors <- sapply(1:1000, function(x){
df <- data.frame(
ID =  1:n,
Hg = round( rnorm(n, mean = mean_Hg, sd = sd_Hg) )
)
est_mean_Hg <- mean(df$Hg)
est_mean_Hg - mean_Hg
})
hist(errors) # Как мы ошибались в разных исследованиях?
print(sqrt(mean(errors^2))) # Как нам правильно усреднить величину ошибки?
#SE, standard error, стандартная ошибка, истинная стандартная ошибка, так как знаем правильный ответ (среднее в ГС)
n <- 10 # Сколько виртуальных добровольцев включим в исследование?
mean_Hg <- +15 # Истинный средний прирост гемоглобина в генеральной совокупности
sd_Hg <- 10 # Истинное стандартное отклонение (вариабельность) прироста гемоглобина в генеральной совокупности
errors <- sapply(1:1000, function(x){
df <- data.frame(
ID =  1:n,
Hg = round( rnorm(n, mean = mean_Hg, sd = sd_Hg) )
)
est_mean_Hg <- mean(df$Hg)
est_mean_Hg - mean_Hg
})
hist(errors) # Как мы ошибались в разных исследованиях?
print(sqrt(mean(errors^2))) # Как нам правильно усреднить величину ошибки?
#SE, standard error, стандартная ошибка, истинная стандартная ошибка, так как знаем правильный ответ (среднее в ГС)
n <- 10 # Сколько виртуальных добровольцев включим в исследование?
mean_Hg <- +15 # Истинный средний прирост гемоглобина в генеральной совокупности
sd_Hg <- 20 # Истинное стандартное отклонение (вариабельность) прироста гемоглобина в генеральной совокупности
errors <- sapply(1:1000, function(x){
df <- data.frame(
ID =  1:n,
Hg = round( rnorm(n, mean = mean_Hg, sd = sd_Hg) )
)
est_mean_Hg <- mean(df$Hg)
est_mean_Hg - mean_Hg
})
hist(errors) # Как мы ошибались в разных исследованиях?
print(sqrt(mean(errors^2))) # Как нам правильно усреднить величину ошибки?
#SE, standard error, стандартная ошибка, истинная стандартная ошибка, так как знаем правильный ответ (среднее в ГС)
n <- 10 # Сколько виртуальных добровольцев включим в исследование?
mean_Hg <- +15 # Истинный средний прирост гемоглобина в генеральной совокупности
sd_Hg <- 30 # Истинное стандартное отклонение (вариабельность) прироста гемоглобина в генеральной совокупности
errors <- sapply(1:1000, function(x){
df <- data.frame(
ID =  1:n,
Hg = round( rnorm(n, mean = mean_Hg, sd = sd_Hg) )
)
est_mean_Hg <- mean(df$Hg)
est_mean_Hg - mean_Hg
})
hist(errors) # Как мы ошибались в разных исследованиях?
print(sqrt(mean(errors^2))) # Как нам правильно усреднить величину ошибки?
#SE, standard error, стандартная ошибка, истинная стандартная ошибка, так как знаем правильный ответ (среднее в ГС)
n <- 10 # Сколько виртуальных добровольцев включим в исследование?
mean_Hg <- +15 # Истинный средний прирост гемоглобина в генеральной совокупности
sd_Hg <- 5 # Истинное стандартное отклонение (вариабельность) прироста гемоглобина в генеральной совокупности
errors <- sapply(1:1000, function(x){
df <- data.frame(
ID =  1:n,
Hg = round( rnorm(n, mean = mean_Hg, sd = sd_Hg) )
)
est_mean_Hg <- mean(df$Hg)
est_mean_Hg - mean_Hg
})
hist(errors) # Как мы ошибались в разных исследованиях?
print(sqrt(mean(errors^2))) # Как нам правильно усреднить величину ошибки?
#SE, standard error, стандартная ошибка, истинная стандартная ошибка, так как знаем правильный ответ (среднее в ГС)
n <- 10 # Сколько виртуальных добровольцев включим в исследование?
mean_Hg <- +15 # Истинный средний прирост гемоглобина в генеральной совокупности
sd_Hg <- 1 # Истинное стандартное отклонение (вариабельность) прироста гемоглобина в генеральной совокупности
errors <- sapply(1:1000, function(x){
df <- data.frame(
ID =  1:n,
Hg = round( rnorm(n, mean = mean_Hg, sd = sd_Hg) )
)
est_mean_Hg <- mean(df$Hg)
est_mean_Hg - mean_Hg
})
hist(errors) # Как мы ошибались в разных исследованиях?
print(sqrt(mean(errors^2))) # Как нам правильно усреднить величину ошибки?
#SE, standard error, стандартная ошибка, истинная стандартная ошибка, так как знаем правильный ответ (среднее в ГС)
n <- 30 # Сколько виртуальных добровольцев включим в исследование?
pr_relapse <- 0.5 # Истинная вероятность рецидива
potential_values <- c("relapse", "non-relapse") # Какие значения может принимать признак
probabilities <- c(pr_relapse, 1-pr_relapse) #  Вероятности
df <- data.frame(
ID =  1:n,
outcome = sample(x = potential_values,
prob = probabilities,
size = n,
replace = TRUE)
)
tb <- table(df$outcome)
print(tb)
barplot(tb)
print(tb["relapse"]/n)
tb
n <- 30 # Сколько виртуальных добровольцев включим в исследование?
pr_relapse <- 0.5 # Истинная вероятность рецидива
potential_values <- c("relapse", "non-relapse") # Какие значения может принимать признак
probabilities <- c(pr_relapse, 1-pr_relapse) #  Вероятности
df <- data.frame(
ID =  1:n,
outcome = sample(x = potential_values,
prob = probabilities,
size = n,
replace = TRUE)
)
tb <- table(df$outcome)
print(tb)
barplot(tb)
print(tb["relapse"]/n)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
sample_size <- 750 # Количество пациентов, прошедших, терапию
Hg_improve <- 15 # Истинное среднее изменение уровня Hg (в ГЕНЕРАЛЬНОЙ СОВОКУПНОСТИ)
Hg_sd <- 10 # Разброс в улучшении Hg
df_trial <- data.frame(
ID = 1:sample_size,
Hg_change = rnorm(sample_size, mean = Hg_improve, sd = Hg_sd)
)
t.test(Hg_change ~ 1, conf.level = 0.95, data = df_trial)
trial_results <- df_trial %>%
t.test(Hg_change ~ 1, conf.level = 0.95, data = .) %>%
broom::tidy()
df_trial %>%
t.test(Hg_change ~ 1, conf.level = 0.95, data = .) %>%
broom::tidy()
sample_size <- 750 # Количество пациентов, прошедших, терапию
Hg_improve <- 15 # Истинное среднее изменение уровня Hg (в ГЕНЕРАЛЬНОЙ СОВОКУПНОСТИ)
Hg_sd <- 10 # Разброс в улучшении Hg
df_trial <- data.frame(
ID = 1:sample_size,
Hg_change = rnorm(sample_size, mean = Hg_improve, sd = Hg_sd)
)
t.test(Hg_change ~ 1, conf.level = 0.95, data = df_trial) #получили среднее и ДИ (только на них смотрим)
#запускаем т тест используя пайп, только тут мы в data указываем ., что означает возьми из указанного в пайпе датасета
trial_results <- df_trial %>%
t.test(Hg_change ~ 1, conf.level = 0.95, data = .) %>%
broom::tidy() %>%
mutate(CI_width = conf.high - conf.low)
trial_results
# Что происходит с ДИ при изменении:
# - объема выборки?
# - стандартного отклонения?
# - уровня доверия?
sample_size <- 7500 # Количество пациентов, прошедших, терапию
Hg_improve <- 15 # Истинное среднее изменение уровня Hg (в ГЕНЕРАЛЬНОЙ СОВОКУПНОСТИ)
Hg_sd <- 10 # Разброс в улучшении Hg
df_trial <- data.frame(
ID = 1:sample_size,
Hg_change = rnorm(sample_size, mean = Hg_improve, sd = Hg_sd)
)
t.test(Hg_change ~ 1, conf.level = 0.95, data = df_trial) #получили среднее и ДИ (только на них смотрим)
#запускаем т тест используя пайп, только тут мы в data указываем ., что означает возьми из указанного в пайпе датасета
trial_results <- df_trial %>%
t.test(Hg_change ~ 1, conf.level = 0.95, data = .) %>%
broom::tidy() %>%
mutate(CI_width = conf.high - conf.low) #создали столбик с шириной ДИ
trial_results
# Что происходит с ДИ при изменении:
# - объема выборки?
# - стандартного отклонения?
# - уровня доверия?
sample_size <- 75 # Количество пациентов, прошедших, терапию
Hg_improve <- 15 # Истинное среднее изменение уровня Hg (в ГЕНЕРАЛЬНОЙ СОВОКУПНОСТИ)
Hg_sd <- 10 # Разброс в улучшении Hg
df_trial <- data.frame(
ID = 1:sample_size,
Hg_change = rnorm(sample_size, mean = Hg_improve, sd = Hg_sd)
)
t.test(Hg_change ~ 1, conf.level = 0.95, data = df_trial) #получили среднее и ДИ (только на них смотрим)
#запускаем т тест используя пайп, только тут мы в data указываем ., что означает возьми из указанного в пайпе датасета
trial_results <- df_trial %>%
t.test(Hg_change ~ 1, conf.level = 0.95, data = .) %>%
broom::tidy() %>%
mutate(CI_width = conf.high - conf.low) #создали столбик с шириной ДИ
trial_results
# Что происходит с ДИ при изменении:
# - объема выборки?
# - стандартного отклонения?
# - уровня доверия?
sample_size <- 750 # Количество пациентов, прошедших, терапию
Hg_improve <- 15 # Истинное среднее изменение уровня Hg (в ГЕНЕРАЛЬНОЙ СОВОКУПНОСТИ)
Hg_sd <- 10 # Разброс в улучшении Hg
df_trial <- data.frame(
ID = 1:sample_size,
Hg_change = rnorm(sample_size, mean = Hg_improve, sd = Hg_sd)
)
t.test(Hg_change ~ 1, conf.level = 0.95, data = df_trial) #получили среднее и ДИ (только на них смотрим)
#запускаем т тест используя пайп, только тут мы в data указываем ., что означает возьми из указанного в пайпе датасета
trial_results <- df_trial %>%
t.test(Hg_change ~ 1, conf.level = 0.95, data = .) %>%
broom::tidy() %>%
mutate(CI_width = conf.high - conf.low) #создали столбик с шириной ДИ
trial_results
# Что происходит с ДИ при изменении:
# - объема выборки?
# - стандартного отклонения?
# - уровня доверия?
sample_size <- 750 # Количество пациентов, прошедших, терапию
Hg_improve <- 15 # Истинное среднее изменение уровня Hg (в ГЕНЕРАЛЬНОЙ СОВОКУПНОСТИ)
Hg_sd <- 100 # Разброс в улучшении Hg
df_trial <- data.frame(
ID = 1:sample_size,
Hg_change = rnorm(sample_size, mean = Hg_improve, sd = Hg_sd)
)
t.test(Hg_change ~ 1, conf.level = 0.95, data = df_trial) #получили среднее и ДИ (только на них смотрим)
#запускаем т тест используя пайп, только тут мы в data указываем ., что означает возьми из указанного в пайпе датасета
trial_results <- df_trial %>%
t.test(Hg_change ~ 1, conf.level = 0.95, data = .) %>%
broom::tidy() %>%
mutate(CI_width = conf.high - conf.low) #создали столбик с шириной ДИ
trial_results
# Что происходит с ДИ при изменении:
# - объема выборки?
# - стандартного отклонения?
# - уровня доверия?
sample_size <- 750 # Количество пациентов, прошедших, терапию
Hg_improve <- 15 # Истинное среднее изменение уровня Hg (в ГЕНЕРАЛЬНОЙ СОВОКУПНОСТИ)
Hg_sd <- 1 # Разброс в улучшении Hg
df_trial <- data.frame(
ID = 1:sample_size,
Hg_change = rnorm(sample_size, mean = Hg_improve, sd = Hg_sd)
)
t.test(Hg_change ~ 1, conf.level = 0.95, data = df_trial) #получили среднее и ДИ (только на них смотрим)
#запускаем т тест используя пайп, только тут мы в data указываем ., что означает возьми из указанного в пайпе датасета
trial_results <- df_trial %>%
t.test(Hg_change ~ 1, conf.level = 0.95, data = .) %>%
broom::tidy() %>%
mutate(CI_width = conf.high - conf.low) #создали столбик с шириной ДИ
trial_results
# Что происходит с ДИ при изменении:
# - объема выборки?
# - стандартного отклонения?
# - уровня доверия?
sample_size <- 750 # Количество пациентов, прошедших, терапию
Hg_improve <- 15 # Истинное среднее изменение уровня Hg (в ГЕНЕРАЛЬНОЙ СОВОКУПНОСТИ)
Hg_sd <- 10 # Разброс в улучшении Hg
df_trial <- data.frame(
ID = 1:sample_size,
Hg_change = rnorm(sample_size, mean = Hg_improve, sd = Hg_sd)
)
t.test(Hg_change ~ 1, conf.level = 0.95, data = df_trial) #получили среднее и ДИ (только на них смотрим)
#запускаем т тест используя пайп, только тут мы в data указываем ., что означает возьми из указанного в пайпе датасета
trial_results <- df_trial %>%
t.test(Hg_change ~ 1, conf.level = 0.95, data = .) %>%
broom::tidy() %>%
mutate(CI_width = conf.high - conf.low) #создали столбик с шириной ДИ
trial_results
# Что происходит с ДИ при изменении:
# - объема выборки?
# - стандартного отклонения?
# - уровня доверия?
sample_size <- 750 # Количество пациентов, прошедших, терапию
Hg_improve <- 15 # Истинное среднее изменение уровня Hg (в ГЕНЕРАЛЬНОЙ СОВОКУПНОСТИ)
Hg_sd <- 100 # Разброс в улучшении Hg
df_trial <- data.frame(
ID = 1:sample_size,
Hg_change = rnorm(sample_size, mean = Hg_improve, sd = Hg_sd)
)
t.test(Hg_change ~ 1, conf.level = 0.95, data = df_trial) #получили среднее и ДИ (только на них смотрим)
#запускаем т тест используя пайп, только тут мы в data указываем ., что означает возьми из указанного в пайпе датасета
trial_results <- df_trial %>%
t.test(Hg_change ~ 1, conf.level = 0.95, data = .) %>%
broom::tidy() %>%
mutate(CI_width = conf.high - conf.low) #создали столбик с шириной ДИ
trial_results
# Что происходит с ДИ при изменении:
# - объема выборки?
# - стандартного отклонения?
# - уровня доверия?
sample_size <- 750 # Количество пациентов, прошедших, терапию
Hg_improve <- 15 # Истинное среднее изменение уровня Hg (в ГЕНЕРАЛЬНОЙ СОВОКУПНОСТИ)
Hg_sd <- 10 # Разброс в улучшении Hg
df_trial <- data.frame(
ID = 1:sample_size,
Hg_change = rnorm(sample_size, mean = Hg_improve, sd = Hg_sd)
)
t.test(Hg_change ~ 1, conf.level = 0.95, data = df_trial) #получили среднее и ДИ (только на них смотрим)
#запускаем т тест используя пайп, только тут мы в data указываем ., что означает возьми из указанного в пайпе датасета
trial_results <- df_trial %>%
t.test(Hg_change ~ 1, conf.level = 0.95, data = .) %>%
broom::tidy() %>%
mutate(CI_width = conf.high - conf.low) #создали столбик с шириной ДИ
trial_results
# Что происходит с ДИ при изменении:
# - объема выборки?
# - стандартного отклонения?
# - уровня доверия?
sample_size <- 750 # Количество пациентов, прошедших, терапию
Hg_improve <- 15 # Истинное среднее изменение уровня Hg (в ГЕНЕРАЛЬНОЙ СОВОКУПНОСТИ)
Hg_sd <- 10 # Разброс в улучшении Hg
df_trial <- data.frame(
ID = 1:sample_size,
Hg_change = rnorm(sample_size, mean = Hg_improve, sd = Hg_sd)
)
t.test(Hg_change ~ 1, conf.level = 0.99, data = df_trial) #получили среднее и ДИ (только на них смотрим)
#запускаем т тест используя пайп, только тут мы в data указываем ., что означает возьми из указанного в пайпе датасета
trial_results <- df_trial %>%
t.test(Hg_change ~ 1, conf.level = 0.95, data = .) %>%
broom::tidy() %>%
mutate(CI_width = conf.high - conf.low) #создали столбик с шириной ДИ
trial_results
# Что происходит с ДИ при изменении:
# - объема выборки?
# - стандартного отклонения?
# - уровня доверия?
sample_size <- 750 # Количество пациентов, прошедших, терапию
Hg_improve <- 15 # Истинное среднее изменение уровня Hg (в ГЕНЕРАЛЬНОЙ СОВОКУПНОСТИ)
Hg_sd <- 10 # Разброс в улучшении Hg
df_trial <- data.frame(
ID = 1:sample_size,
Hg_change = rnorm(sample_size, mean = Hg_improve, sd = Hg_sd)
)
t.test(Hg_change ~ 1, conf.level = 0.99, data = df_trial) #получили среднее и ДИ (только на них смотрим)
#запускаем т тест используя пайп, только тут мы в data указываем ., что означает возьми из указанного в пайпе датасета
trial_results <- df_trial %>%
t.test(Hg_change ~ 1, conf.level = 0.95, data = .) %>%
broom::tidy() %>%
mutate(CI_width = conf.high - conf.low) #создали столбик с шириной ДИ
trial_results
# Что происходит с ДИ при изменении:
# - объема выборки?
# - стандартного отклонения?
# - уровня доверия?
sample_size <- 750 # Количество пациентов, прошедших, терапию
Hg_improve <- 15 # Истинное среднее изменение уровня Hg (в ГЕНЕРАЛЬНОЙ СОВОКУПНОСТИ)
Hg_sd <- 10 # Разброс в улучшении Hg
df_trial <- data.frame(
ID = 1:sample_size,
Hg_change = rnorm(sample_size, mean = Hg_improve, sd = Hg_sd)
)
t.test(Hg_change ~ 1, conf.level = 0.90, data = df_trial) #получили среднее и ДИ (только на них смотрим)
#запускаем т тест используя пайп, только тут мы в data указываем ., что означает возьми из указанного в пайпе датасета
trial_results <- df_trial %>%
t.test(Hg_change ~ 1, conf.level = 0.95, data = .) %>%
broom::tidy() %>%
mutate(CI_width = conf.high - conf.low) #создали столбик с шириной ДИ
trial_results
# Что происходит с ДИ при изменении:
# - объема выборки?
# - стандартного отклонения?
# - уровня доверия?
sample_size <- 750 # Количество пациентов, прошедших, терапию
Hg_improve <- 15 # Истинное среднее изменение уровня Hg (в ГЕНЕРАЛЬНОЙ СОВОКУПНОСТИ)
Hg_sd <- 10 # Разброс в улучшении Hg
df_trial <- data.frame(
ID = 1:sample_size,
Hg_change = rnorm(sample_size, mean = Hg_improve, sd = Hg_sd)
)
t.test(Hg_change ~ 1, conf.level = 0.90, data = df_trial) #получили среднее и ДИ (только на них смотрим)
#запускаем т тест используя пайп, только тут мы в data указываем ., что означает возьми из указанного в пайпе датасета
trial_results <- df_trial %>%
t.test(Hg_change ~ 1, conf.level = 0.99, data = .) %>%
broom::tidy() %>%
mutate(CI_width = conf.high - conf.low) #создали столбик с шириной ДИ
trial_results
# Что происходит с ДИ при изменении:
# - объема выборки?
# - стандартного отклонения?
# - уровня доверия?
sample_size <- 750 # Количество пациентов, прошедших, терапию
Hg_improve <- 15 # Истинное среднее изменение уровня Hg (в ГЕНЕРАЛЬНОЙ СОВОКУПНОСТИ)
Hg_sd <- 10 # Разброс в улучшении Hg
df_trial <- data.frame(
ID = 1:sample_size,
Hg_change = rnorm(sample_size, mean = Hg_improve, sd = Hg_sd)
)
t.test(Hg_change ~ 1, conf.level = 0.90, data = df_trial) #получили среднее и ДИ (только на них смотрим)
#запускаем т тест используя пайп, только тут мы в data указываем ., что означает возьми из указанного в пайпе датасета
trial_results <- df_trial %>%
t.test(Hg_change ~ 1, conf.level = 0.90, data = .) %>%
broom::tidy() %>%
mutate(CI_width = conf.high - conf.low) #создали столбик с шириной ДИ
trial_results
# Что происходит с ДИ при изменении:
# - объема выборки?
# - стандартного отклонения?
# - уровня доверия?
sample_size <- 750 # Количество пациентов, прошедших, терапию
Hg_improve <- 15 # Истинное среднее изменение уровня Hg (в ГЕНЕРАЛЬНОЙ СОВОКУПНОСТИ)
Hg_sd <- 10 # Разброс в улучшении Hg
df_trial <- data.frame(
ID = 1:sample_size,
Hg_change = rnorm(sample_size, mean = Hg_improve, sd = Hg_sd)
)
t.test(Hg_change ~ 1, conf.level = 0.095, data = df_trial) #получили среднее и ДИ (только на них смотрим)
#запускаем т тест используя пайп, только тут мы в data указываем ., что означает возьми из указанного в пайпе датасета
trial_results <- df_trial %>%
t.test(Hg_change ~ 1, conf.level = 0.90, data = .) %>%
broom::tidy() %>%
mutate(CI_width = conf.high - conf.low) #создали столбик с шириной ДИ
trial_results
# Что происходит с ДИ при изменении:
# - объема выборки?
# - стандартного отклонения?
# - уровня доверия?
sample_size <- 750 # Количество пациентов, прошедших, терапию
Hg_improve <- 15 # Истинное среднее изменение уровня Hg (в ГЕНЕРАЛЬНОЙ СОВОКУПНОСТИ)
Hg_sd <- 10 # Разброс в улучшении Hg
df_trial <- data.frame(
ID = 1:sample_size,
Hg_change = rnorm(sample_size, mean = Hg_improve, sd = Hg_sd)
)
t.test(Hg_change ~ 1, conf.level = 0.095, data = df_trial) #получили среднее и ДИ (только на них смотрим)
#запускаем т тест используя пайп, только тут мы в data указываем ., что означает возьми из указанного в пайпе датасета
trial_results <- df_trial %>%
t.test(Hg_change ~ 1, conf.level = 0.095, data = .) %>%
broom::tidy() %>%
mutate(CI_width = conf.high - conf.low) #создали столбик с шириной ДИ
trial_results
# Что происходит с ДИ при изменении:
# - объема выборки?
# - стандартного отклонения?
# - уровня доверия?
sample_size <- 750 # Количество пациентов, прошедших, терапию
Hg_improve <- 15 # Истинное среднее изменение уровня Hg (в ГЕНЕРАЛЬНОЙ СОВОКУПНОСТИ)
Hg_sd <- 10 # Разброс в улучшении Hg
df_trial <- data.frame(
ID = 1:sample_size,
Hg_change = rnorm(sample_size, mean = Hg_improve, sd = Hg_sd)
)
t.test(Hg_change ~ 1, conf.level = 0.095, data = df_trial) #получили среднее и ДИ (только на них смотрим)
#запускаем т тест используя пайп, только тут мы в data указываем ., что означает возьми из указанного в пайпе датасета
trial_results <- df_trial %>%
t.test(Hg_change ~ 1, conf.level = 0.9999, data = .) %>%
broom::tidy() %>%
mutate(CI_width = conf.high - conf.low) #создали столбик с шириной ДИ
trial_results
# Что происходит с ДИ при изменении:
# - объема выборки?
# - стандартного отклонения?
# - уровня доверия?
sample_size <- 750 # Количество пациентов, прошедших, терапию
Hg_improve <- 15 # Истинное среднее изменение уровня Hg (в ГЕНЕРАЛЬНОЙ СОВОКУПНОСТИ)
Hg_sd <- 10 # Разброс в улучшении Hg
df_trial <- data.frame(
ID = 1:sample_size,
Hg_change = rnorm(sample_size, mean = Hg_improve, sd = Hg_sd)
)
t.test(Hg_change ~ 1, conf.level = 0.095, data = df_trial) #получили среднее и ДИ (только на них смотрим)
#запускаем т тест используя пайп, только тут мы в data указываем ., что означает возьми из указанного в пайпе датасета
trial_results <- df_trial %>%
t.test(Hg_change ~ 1, conf.level = 0.95, data = .) %>%
broom::tidy() %>%
mutate(CI_width = conf.high - conf.low) #создали столбик с шириной ДИ
trial_results
# Что происходит с ДИ при изменении:
# - объема выборки?
# - стандартного отклонения?
# - уровня доверия?
num_experiments <- 100 # Сколько экспериментов будем проводить?
sample_size <- 3 # Количество пациентов, прошедших, терапию
Hg_improve <- 15 # Истинное среднее изменение уровня Hg (в ГЕНЕРАЛЬНОЙ СОВОКУПНОСТИ)
Hg_sd <- 10 # Разброс в улучшении Hg
df_trial <- data.frame(
exp_ID = rep(1:num_experiments, each = sample_size),
patient_ID = rep(1:sample_size, num_experiments),
Hg_change = rnorm(sample_size*num_experiments, mean = Hg_improve, sd = Hg_sd)
)
df_trial
hist(df_trial$Hg_change)
trial_results <- df_trial %>%
group_by(exp_ID) %>%
nest()
View(trial_results)
View(trial_results[[2]][[1]])
trial_results <- df_trial %>%
group_by(exp_ID) %>%
nest() %>%
mutate(est_results = purrr::map(data, ~t.test(Hg_change ~ 1, conf.level = 0.95, data = .)))
trial_results <- df_trial %>%
group_by(exp_ID) %>%
nest() %>%
mutate(est_results = purrr::map(data, ~t.test(Hg_change ~ 1, conf.level = 0.95, data = .)))
View(trial_results)
View(trial_results[[2]][[1]])
View(trial_results[[3]][[1]])
View(trial_results)
trial_results <- df_trial %>%
group_by(exp_ID) %>%
nest() %>%
mutate(est_results = purrr::map(data, ~t.test(Hg_change ~ 1, conf.level = 0.95, data = .))) %>%
mutate(vector_est_results = purrr::map(est_results, ~ broom::tidy(.)))
View(trial_results)
View(trial_results[[4]][[1]])
trial_results <- df_trial %>%
group_by(exp_ID) %>%
nest() %>%
mutate(est_results = purrr::map(data, ~t.test(Hg_change ~ 1, conf.level = 0.95, data = .))) %>%
mutate(vector_est_results = purrr::map(est_results, ~ broom::tidy(.))) %>%
dplyr::select(-c(data,est_results)) %>%
unnest(vector_est_results)
View(trial_results)
